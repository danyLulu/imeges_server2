# üñºÔ∏è Image Hosting Service

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ö–æ—Å—Ç–∏–Ω–≥–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ Python –∏ Nginx —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–æ—Ä–º–∞—Ç–æ–≤ JPG, PNG, GIF
- **–ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑–¥–∞—á–∞** —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ Nginx
- **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤** –ø–æ —Ä–∞–∑–º–µ—Ä—É (–º–∞–∫—Å–∏–º—É–º 5 –ú–ë) –∏ —Ñ–æ—Ä–º–∞—Ç—É
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Ñ–∞–π–ª
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** —Å Docker –∏ Docker Compose
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫** –ø—Ä–∏ —Å–±–æ—è—Ö
- **Health checks** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker 20.10+
- Docker Compose 2.0+
- 2 –ì–ë —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repository-url>
cd images-server3
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
docker compose up --build
```

### –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å—É

- **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: http://localhost:8080
- **–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –±—ç–∫–µ–Ω–¥—É**: http://localhost:8000
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: http://localhost:8080/images/<–∏–º—è_—Ñ–∞–π–ª–∞>

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îú‚îÄ‚îÄ app.py                # Python-–±—ç–∫–µ–Ω–¥
‚îú‚îÄ‚îÄ requirements.txt      # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ Dockerfile            # Dockerfile –¥–ª—è –±—ç–∫–µ–Ω–¥–∞
‚îú‚îÄ‚îÄ docker-compose.yml    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker Compose
‚îú‚îÄ‚îÄ nginx.conf            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
‚îú‚îÄ‚îÄ images/               # –ü–∞–ø–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (volume)
‚îú‚îÄ‚îÄ logs/                 # –ü–∞–ø–∫–∞ –¥–ª—è –ª–æ–≥–æ–≤ (volume)
‚îî‚îÄ‚îÄ static/               # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã (CSS/JS)
```

## üîß API

### POST /upload

–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `file` (multipart/form-data) - —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–û—Ç–≤–µ—Ç –ø—Ä–∏ —É—Å–ø–µ—Ö–µ:**
```json
{
  "status": "success",
  "message": "–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω",
  "filename": "unique_filename.jpg",
  "url": "/images/unique_filename.jpg",
  "processing_time": "0.15—Å"
}
```

**–û—Ç–≤–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ:**
```json
{
  "status": "error",
  "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏"
}
```

### GET /

–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∑–∞–≥—Ä—É–∑–∫–∏.

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤**: —Ç–æ–ª—å–∫–æ JPG, PNG, GIF
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞**: –º–∞–∫—Å–∏–º—É–º 5 –ú–ë
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤**: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
- **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø**: —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Nginx
- **–ù–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ú–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω–æ—Å—Ç—å**: –¥–æ 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫
- **–°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏**: –º–µ–Ω–µ–µ 1 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è —Ñ–∞–π–ª–æ–≤ –¥–æ 5 –ú–ë
- **–†–∞–∑–¥–∞—á–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**: –º–µ–Ω–µ–µ 100 –º—Å —á–µ—Ä–µ–∑ Nginx
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 1 –≥–æ–¥
- **–°–∂–∞—Ç–∏–µ**: gzip –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª `logs/app.log` –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
[2025-01-24 14:00:00] INFO: –£—Å–ø–µ—Ö: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 'photo.jpg' –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∑–∞ 0.15—Å
[2025-01-24 14:01:00] WARNING: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ - —Ñ–∞–π–ª –ø—Ä–µ–≤—ã—à–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä
```

## üîÑ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º

```bash
# –ó–∞–ø—É—Å–∫
docker compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose down

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker compose logs -f

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞
docker compose up --build

# –û—á–∏—Å—Ç–∫–∞ volumes (—É–¥–∞–ª—è–µ—Ç –≤—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –ª–æ–≥–∏)
docker compose down -v
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
```bash
docker compose ps
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
```bash
# –õ–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞
docker compose logs app

# –õ–æ–≥–∏ Nginx
docker compose logs nginx
```

### –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
```bash
# –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±—ç–∫–µ–Ω–¥–∞
docker compose exec app bash

# –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Nginx
docker compose exec nginx sh
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–°–µ—Ä–≤–∏—Å –≤–∫–ª—é—á–∞–µ—Ç health checks:
- **–ë—ç–∫–µ–Ω–¥**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –Ω–∞ –ø–æ—Ä—Ç—É 8000
- **Nginx**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –Ω–∞ –ø–æ—Ä—Ç—É 80

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞

–í —Ñ–∞–π–ª–µ `app.py` –∏–∑–º–µ–Ω–∏—Ç–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É:
```python
MAX_FILE_SIZE = 5 * 1024 * 1024  # 5 –ú–ë
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤

–í —Ñ–∞–π–ª–µ `app.py` –æ–±–Ω–æ–≤–∏—Ç–µ —Å–ø–∏—Å–æ–∫:
```python
ALLOWED_EXTENSIONS = ['.jpg', '.jpeg', '.png', '.gif', '.webp']
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ reverse proxy (–Ω–∞–ø—Ä–∏–º–µ—Ä, Traefik)
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus + Grafana)
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ volumes
5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–µ volumes –¥–ª—è –¥–∞–Ω–Ω—ã—Ö

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker compose logs`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç—ã 8000 –∏ 8080 —Å–≤–æ–±–æ–¥–Ω—ã

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –ø—Ä–∏ –ø–æ–º–æ—â–∏ JavaRush school 
 
## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ SQL (PostgreSQL)

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

- **–°–£–ë–î**: PostgreSQL 16
- **–ë–∞–∑–∞**: `images_db`
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: `postgres`
- **–ü–∞—Ä–æ–ª—å**: `password`
- **–•–æ—Å—Ç (–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö)**: `db:5432`
- **–•–æ—Å—Ç (—Å —Ö–æ—Å—Ç–∞)**: `localhost:5433`

–≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `docker-compose.yml`: `DB_NAME`, `DB_USER`, `DB_PASSWORD`, `DB_HOST`, `DB_PORT`.

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

- –° —Ö–æ—Å—Ç-–º–∞—à–∏–Ω—ã (–Ω—É–∂–µ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `psql`):
```bash
psql -h localhost -p 5433 -U postgres -d images_db
```

- –ò–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ë–î:
```bash
docker compose exec -e PGPASSWORD=password db psql -U postgres -d images_db
```

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã

–°—Ö–µ–º–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ. –î–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```sql
CREATE TABLE IF NOT EXISTS images (
  id SERIAL PRIMARY KEY,
  filename TEXT NOT NULL,
  original_name TEXT NOT NULL,
  size INTEGER NOT NULL,
  upload_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  file_type TEXT NOT NULL
);
```

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏–Ω–¥–µ–∫—Å—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ –ø–æ–∏—Å–∫–∞):
```sql
CREATE INDEX IF NOT EXISTS idx_images_upload_time ON images (upload_time DESC);
CREATE INDEX IF NOT EXISTS idx_images_file_type ON images (file_type);
```

### –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã

- –í—Å—Ç–∞–≤–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
```sql
INSERT INTO images (filename, original_name, size, file_type)
VALUES ('<generated>.png', 'source.png', 123456, 'png')
RETURNING id;
```

- –°–ø–∏—Å–æ–∫ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π (10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É):
```sql
-- page = 1 -> OFFSET 0, page = 2 -> OFFSET 10 –∏ —Ç.–¥.
SELECT id, filename, original_name, size, upload_time, file_type
FROM images
ORDER BY upload_time DESC
LIMIT 10 OFFSET 0;
```

- –ü–æ–¥—Å—á—ë—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞:
```sql
SELECT COUNT(*) AS cnt FROM images;
```

- –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ `id`:
```sql
DELETE FROM images WHERE id = $1; -- –ø–æ–¥—Å—Ç–∞–≤—å—Ç–µ –Ω—É–∂–Ω—ã–π id
```

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

- –ë—ç–∫–∞–ø –≤ —Ñ–∞–π–ª –Ω–∞ —Ö–æ—Å—Ç–µ (stdout –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ë–î –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ —Ñ–∞–π–ª):
```bash
docker compose exec db pg_dump -U postgres -d images_db > backups/backup_$(date +%F_%H-%M-%S).sql
```

- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ñ–∞–π–ª–∞ –Ω–∞ —Ö–æ—Å—Ç–µ:
```bash
cat backups/backup_YYYY-MM-DD_HH-MM-SS.sql | docker compose exec -T db psql -U postgres -d images_db
```

- –ë—ç–∫–∞–ø –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã:
```bash
docker compose exec db pg_dump -U postgres -d images_db -t images > backups/images_$(date +%F_%H-%M-%S).sql
```

### –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

- –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:
```sql
SELECT pid, usename, application_name, state, query
FROM pg_stat_activity
ORDER BY state;
```

- –ê–Ω–∞–ª–∏–∑ –∏ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
```sql
ANALYZE;
```

- –û—á–∏—Å—Ç–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ (–≤ –ø—Ä–æ—Å—Ç—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö):
```sql
VACUUM;
```

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –∫–æ–º–∞–Ω–¥—ã `VACUUM FULL` –∏ —Ç.–ø. –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –º–æ–≥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã.